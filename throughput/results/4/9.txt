BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270809256.808442
 ALGERIA                   |   1997 | 458906410.639026
 ALGERIA                   |   1996 | 466019550.243381
 ALGERIA                   |   1995 | 465955094.051075
 ALGERIA                   |   1994 | 459718416.445902
 ALGERIA                   |   1993 | 460400802.666449
 ALGERIA                   |   1992 | 463813404.950232
 ARGENTINA                 |   1998 | 272752878.352074
 ARGENTINA                 |   1997 | 468896963.019226
 ARGENTINA                 |   1996 | 467684814.797494
 ARGENTINA                 |   1995 | 471535102.874085
 ARGENTINA                 |   1994 | 462773914.013264
 ARGENTINA                 |   1993 |  467359704.79842
 ARGENTINA                 |   1992 | 464917173.127639
 BRAZIL                    |   1998 | 271994361.406228
 BRAZIL                    |   1997 | 460602191.890735
 BRAZIL                    |   1996 | 469326111.515845
 BRAZIL                    |   1995 | 469919948.171322
 BRAZIL                    |   1994 | 468731797.762754
 BRAZIL                    |   1993 | 462733310.159033
 BRAZIL                    |   1992 | 475403879.985111
 CANADA                    |   1998 | 281073558.341744
 CANADA                    |   1997 | 478923801.185947
 CANADA                    |   1996 | 473570262.334948
 CANADA                    |   1995 | 479688676.739115
 CANADA                    |   1994 |  487908914.74185
 CANADA                    |   1993 | 477159185.804438
 CANADA                    |   1992 | 472986165.599462
 CHINA                     |   1998 | 271039815.018281
 CHINA                     |   1997 |  454290919.32264
 CHINA                     |   1996 | 472010028.722902
 CHINA                     |   1995 | 469526374.434337
 CHINA                     |   1994 | 464999458.412342
 CHINA                     |   1993 | 467192863.654647
 CHINA                     |   1992 | 471535712.217309
 EGYPT                     |   1998 | 271213549.142326
 EGYPT                     |   1997 | 469548831.225001
 EGYPT                     |   1996 | 472938026.011829
 EGYPT                     |   1995 | 463234365.992592
 EGYPT                     |   1994 | 456464311.355831
 EGYPT                     |   1993 | 466577879.840355
 EGYPT                     |   1992 | 468820138.654952
 ETHIOPIA                  |   1998 | 264760060.718209
 ETHIOPIA                  |   1997 | 453717009.367627
 ETHIOPIA                  |   1996 |  450315010.43063
 ETHIOPIA                  |   1995 | 454114477.412761
 ETHIOPIA                  |   1994 | 455514720.918428
 ETHIOPIA                  |   1993 | 458589431.756082
 ETHIOPIA                  |   1992 |  458267681.48671
 FRANCE                    |   1998 | 273999590.301004
 FRANCE                    |   1997 | 464450252.871338
 FRANCE                    |   1996 | 465656929.003752
 FRANCE                    |   1995 | 458587295.139747
 FRANCE                    |   1994 | 459675695.243704
 FRANCE                    |   1993 | 461173332.843149
 FRANCE                    |   1992 | 460917007.373877
 GERMANY                   |   1998 | 279105163.529317
 GERMANY                   |   1997 | 477318344.172628
 GERMANY                   |   1996 | 475829505.567323
 GERMANY                   |   1995 | 464726063.085923
 GERMANY                   |   1994 | 481421518.705309
 GERMANY                   |   1993 | 474136460.405551
 GERMANY                   |   1992 | 479142176.021682
 INDIA                     |   1998 | 276099381.664107
 INDIA                     |   1997 | 465299227.462469
 INDIA                     |   1996 |  470588712.44339
 INDIA                     |   1995 |  475398769.14224
 INDIA                     |   1994 | 468866121.224066
 INDIA                     |   1993 |  468599428.38876
 INDIA                     |   1992 | 476951132.348261
 INDONESIA                 |   1998 | 275519261.361718
 INDONESIA                 |   1997 |  461113408.28764
 INDONESIA                 |   1996 | 465703549.805868
 INDONESIA                 |   1995 | 468623149.780685
 INDONESIA                 |   1994 |  463623455.56451
 INDONESIA                 |   1993 | 467948871.209205
 INDONESIA                 |   1992 | 458337476.183981
 IRAN                      |   1998 | 271891523.107393
 IRAN                      |   1997 | 464936969.891789
 IRAN                      |   1996 | 470334012.082968
 IRAN                      |   1995 | 470117643.622132
 IRAN                      |   1994 | 466289998.122122
 IRAN                      |   1993 | 463163931.438839
 IRAN                      |   1992 | 465186342.690156
 IRAQ                      |   1998 | 275360235.372696
 IRAQ                      |   1997 | 471640886.614438
 IRAQ                      |   1996 | 477197448.719837
 IRAQ                      |   1995 | 471261722.084058
 IRAQ                      |   1994 | 473899645.787988
 IRAQ                      |   1993 | 475539761.424096
 IRAQ                      |   1992 | 473970925.892975
 JAPAN                     |   1998 | 273773869.535847
 JAPAN                     |   1997 | 464042872.142796
 JAPAN                     |   1996 | 463561084.436808
 JAPAN                     |   1995 | 457550373.758621
 JAPAN                     |   1994 | 451463510.783209
 JAPAN                     |   1993 | 462583623.705081
 JAPAN                     |   1992 | 462907069.292173
 JORDAN                    |   1998 | 272687113.427975
 JORDAN                    |   1997 | 468408609.496633
 JORDAN                    |   1996 | 459742371.299198
 JORDAN                    |   1995 | 453353037.604672
 JORDAN                    |   1994 | 462276896.817362
 JORDAN                    |   1993 |  464670705.04444
 JORDAN                    |   1992 | 462903448.929293
 KENYA                     |   1998 | 270887519.968943
 KENYA                     |   1997 | 467634490.590329
 KENYA                     |   1996 | 472218480.377174
 KENYA                     |   1995 |  470799335.04627
 KENYA                     |   1994 | 473060013.833712
 KENYA                     |   1993 | 469368240.620339
 KENYA                     |   1992 | 474358657.610454
 MOROCCO                   |   1998 | 266242881.702148
 MOROCCO                   |   1997 |  468685220.76789
 MOROCCO                   |   1996 | 466353433.921811
 MOROCCO                   |   1995 | 462136054.391508
 MOROCCO                   |   1994 | 460453358.065729
 MOROCCO                   |   1993 | 466035832.702456
 MOROCCO                   |   1992 | 464832295.306931
 MOZAMBIQUE                |   1998 |  270980976.48965
 MOZAMBIQUE                |   1997 |  453980350.09664
 MOZAMBIQUE                |   1996 | 454687407.304075
 MOZAMBIQUE                |   1995 |  458694973.57271
 MOZAMBIQUE                |   1994 | 462252092.897678
 MOZAMBIQUE                |   1993 | 458894276.939253
 MOZAMBIQUE                |   1992 | 461215397.130591
 PERU                      |   1998 |  269102381.51837
 PERU                      |   1997 | 469783608.589493
 PERU                      |   1996 | 471385882.415395
 PERU                      |   1995 | 467452043.838615
 PERU                      |   1994 | 459918972.162384
 PERU                      |   1993 | 470081291.642579
 PERU                      |   1992 | 461372391.623589
 ROMANIA                   |   1998 |  275927406.72889
 ROMANIA                   |   1997 | 464657899.911747
 ROMANIA                   |   1996 | 471577294.413191
 ROMANIA                   |   1995 | 467497552.292688
 ROMANIA                   |   1994 |  465464730.21152
 ROMANIA                   |   1993 | 473417987.431319
 ROMANIA                   |   1992 | 471446261.122069
 RUSSIA                    |   1998 | 270441369.429605
 RUSSIA                    |   1997 | 465077577.081799
 RUSSIA                    |   1996 | 475366947.964203
 RUSSIA                    |   1995 |  467259626.40805
 RUSSIA                    |   1994 | 463090602.478229
 RUSSIA                    |   1993 | 468415497.061962
 RUSSIA                    |   1992 | 464374347.201356
 SAUDI ARABIA              |   1998 | 278705203.754152
 SAUDI ARABIA              |   1997 | 475508659.748973
 SAUDI ARABIA              |   1996 | 463289880.462148
 SAUDI ARABIA              |   1995 | 468732059.571896
 SAUDI ARABIA              |   1994 | 471903235.434435
 SAUDI ARABIA              |   1993 |  461273328.42503
 SAUDI ARABIA              |   1992 | 467426397.590216
 UNITED KINGDOM            |   1998 | 263470877.436334
 UNITED KINGDOM            |   1997 | 450041957.591327
 UNITED KINGDOM            |   1996 | 453822248.474449
 UNITED KINGDOM            |   1995 | 458648494.349423
 UNITED KINGDOM            |   1994 | 465360540.754964
 UNITED KINGDOM            |   1993 | 452590182.326774
 UNITED KINGDOM            |   1992 | 453515609.988153
 UNITED STATES             |   1998 | 266764292.561123
 UNITED STATES             |   1997 | 466565782.572929
 UNITED STATES             |   1996 |  462751950.09155
 UNITED STATES             |   1995 | 462938958.765647
 UNITED STATES             |   1994 |  463992556.25122
 UNITED STATES             |   1993 | 460503164.498385
 UNITED STATES             |   1992 | 460650752.104572
 VIETNAM                   |   1998 | 273250592.655966
 VIETNAM                   |   1997 |  462739410.99564
 VIETNAM                   |   1996 | 466299482.030654
 VIETNAM                   |   1995 | 467900189.640403
 VIETNAM                   |   1994 | 475688542.000003
 VIETNAM                   |   1993 | 466552580.699347
 VIETNAM                   |   1992 | 461354525.228405
(175 rows)

COMMIT;
COMMIT

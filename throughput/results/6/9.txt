BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 267292292.686776
 ALGERIA                   |   1997 | 455565154.275842
 ALGERIA                   |   1996 | 452927571.928086
 ALGERIA                   |   1995 | 459803439.408719
 ALGERIA                   |   1994 | 451246083.818236
 ALGERIA                   |   1993 | 456881307.656829
 ALGERIA                   |   1992 | 457925646.886633
 ARGENTINA                 |   1998 |  272675706.25962
 ARGENTINA                 |   1997 | 473900760.748747
 ARGENTINA                 |   1996 |   470284369.1371
 ARGENTINA                 |   1995 | 467223918.161774
 ARGENTINA                 |   1994 |  475466265.86614
 ARGENTINA                 |   1993 | 467593817.784362
 ARGENTINA                 |   1992 | 475479925.893587
 BRAZIL                    |   1998 | 275005965.072344
 BRAZIL                    |   1997 | 467511432.190123
 BRAZIL                    |   1996 | 467222874.706242
 BRAZIL                    |   1995 | 466315222.520471
 BRAZIL                    |   1994 | 469148468.609966
 BRAZIL                    |   1993 | 464858530.180446
 BRAZIL                    |   1992 | 477854207.489564
 CANADA                    |   1998 | 281118877.731566
 CANADA                    |   1997 | 481396325.466704
 CANADA                    |   1996 | 478304977.187715
 CANADA                    |   1995 | 476186380.548942
 CANADA                    |   1994 | 485622865.894862
 CANADA                    |   1993 | 479994009.863781
 CANADA                    |   1992 | 477456290.005774
 CHINA                     |   1998 | 274250932.506461
 CHINA                     |   1997 | 468652850.778264
 CHINA                     |   1996 | 472223066.353645
 CHINA                     |   1995 | 456650622.331682
 CHINA                     |   1994 | 468945434.621346
 CHINA                     |   1993 | 475274549.413046
 CHINA                     |   1992 | 468923870.997813
 EGYPT                     |   1998 | 276728449.484603
 EGYPT                     |   1997 | 462233493.689608
 EGYPT                     |   1996 | 466535507.129994
 EGYPT                     |   1995 | 462925918.881032
 EGYPT                     |   1994 | 464399608.624308
 EGYPT                     |   1993 | 459881151.866148
 EGYPT                     |   1992 | 462673349.305804
 ETHIOPIA                  |   1998 | 263580584.593165
 ETHIOPIA                  |   1997 | 450917823.858811
 ETHIOPIA                  |   1996 | 453139191.990056
 ETHIOPIA                  |   1995 | 454103692.436234
 ETHIOPIA                  |   1994 | 459601472.991855
 ETHIOPIA                  |   1993 | 454210794.609814
 ETHIOPIA                  |   1992 | 453125334.149605
 FRANCE                    |   1998 | 269229446.621343
 FRANCE                    |   1997 | 454037538.546173
 FRANCE                    |   1996 | 460037793.146969
 FRANCE                    |   1995 | 466397774.861232
 FRANCE                    |   1994 |  453857209.72186
 FRANCE                    |   1993 | 460012423.926482
 FRANCE                    |   1992 | 459384727.878438
 GERMANY                   |   1998 | 278054059.542723
 GERMANY                   |   1997 | 473839509.553651
 GERMANY                   |   1996 | 472689547.048947
 GERMANY                   |   1995 | 468988162.564062
 GERMANY                   |   1994 |  471796914.20376
 GERMANY                   |   1993 | 473223445.562797
 GERMANY                   |   1992 | 467452939.631352
 INDIA                     |   1998 | 271035143.508114
 INDIA                     |   1997 | 468809480.009623
 INDIA                     |   1996 | 466510889.265953
 INDIA                     |   1995 |  465069024.49296
 INDIA                     |   1994 | 469897824.385877
 INDIA                     |   1993 | 464429165.517375
 INDIA                     |   1992 | 470944800.356019
 INDONESIA                 |   1998 | 268484512.983968
 INDONESIA                 |   1997 | 463298798.650911
 INDONESIA                 |   1996 | 458513899.747345
 INDONESIA                 |   1995 |  458088698.64313
 INDONESIA                 |   1994 | 463369278.783649
 INDONESIA                 |   1993 | 458369516.053815
 INDONESIA                 |   1992 | 459605607.766252
 IRAN                      |   1998 | 268296180.136898
 IRAN                      |   1997 | 446802641.149917
 IRAN                      |   1996 | 460529511.805397
 IRAN                      |   1995 |  454824769.88001
 IRAN                      |   1994 | 459831303.182014
 IRAN                      |   1993 | 453911424.894929
 IRAN                      |   1992 | 455553596.066419
 IRAQ                      |   1998 | 277189288.917409
 IRAQ                      |   1997 |  470577415.77941
 IRAQ                      |   1996 |  473310084.41463
 IRAQ                      |   1995 |  472150545.64794
 IRAQ                      |   1994 |  469124185.43723
 IRAQ                      |   1993 | 469350391.027694
 IRAQ                      |   1992 | 465029115.011471
 JAPAN                     |   1998 | 271264136.155471
 JAPAN                     |   1997 | 466376695.177757
 JAPAN                     |   1996 | 460715092.589401
 JAPAN                     |   1995 | 464268468.025965
 JAPAN                     |   1994 | 469598374.362079
 JAPAN                     |   1993 | 473952514.719466
 JAPAN                     |   1992 | 465600946.165433
 JORDAN                    |   1998 | 271265054.440111
 JORDAN                    |   1997 |  465391040.02714
 JORDAN                    |   1996 | 456671508.259626
 JORDAN                    |   1995 | 459422116.327775
 JORDAN                    |   1994 | 459571649.749342
 JORDAN                    |   1993 | 461772183.744633
 JORDAN                    |   1992 | 463527253.196603
 KENYA                     |   1998 |  272675524.47842
 KENYA                     |   1997 | 460925331.250484
 KENYA                     |   1996 | 467764593.686052
 KENYA                     |   1995 | 459019597.676938
 KENYA                     |   1994 | 460317787.331769
 KENYA                     |   1993 | 465749796.773627
 KENYA                     |   1992 | 464030532.283916
 MOROCCO                   |   1998 | 272894338.427613
 MOROCCO                   |   1997 |  466835806.99477
 MOROCCO                   |   1996 | 472502954.877202
 MOROCCO                   |   1995 | 469969178.107934
 MOROCCO                   |   1994 | 463753499.277658
 MOROCCO                   |   1993 | 468851428.790959
 MOROCCO                   |   1992 | 471106816.995569
 MOZAMBIQUE                |   1998 | 273564184.394181
 MOZAMBIQUE                |   1997 | 455492241.435927
 MOZAMBIQUE                |   1996 | 464412487.631291
 MOZAMBIQUE                |   1995 | 460102613.904963
 MOZAMBIQUE                |   1994 | 458751511.102122
 MOZAMBIQUE                |   1993 | 454041131.999949
 MOZAMBIQUE                |   1992 | 461294349.917064
 PERU                      |   1998 | 268459007.000603
 PERU                      |   1997 | 474371798.336687
 PERU                      |   1996 | 470142326.819702
 PERU                      |   1995 | 458061393.906642
 PERU                      |   1994 | 467551100.966694
 PERU                      |   1993 | 466964553.694515
 PERU                      |   1992 | 476490529.002165
 ROMANIA                   |   1998 | 271957205.978738
 ROMANIA                   |   1997 | 459103705.268168
 ROMANIA                   |   1996 | 466244676.724219
 ROMANIA                   |   1995 | 462162861.983129
 ROMANIA                   |   1994 | 456959626.585342
 ROMANIA                   |   1993 | 457789686.634464
 ROMANIA                   |   1992 | 460446312.217679
 RUSSIA                    |   1998 |  280717227.63734
 RUSSIA                    |   1997 | 467964282.151199
 RUSSIA                    |   1996 | 480326609.351928
 RUSSIA                    |   1995 | 471624388.440305
 RUSSIA                    |   1994 | 471578953.237535
 RUSSIA                    |   1993 | 467095368.105436
 RUSSIA                    |   1992 | 464689169.184664
 SAUDI ARABIA              |   1998 |  279287258.26312
 SAUDI ARABIA              |   1997 | 464989247.132425
 SAUDI ARABIA              |   1996 | 477273240.673384
 SAUDI ARABIA              |   1995 | 465611103.520528
 SAUDI ARABIA              |   1994 | 466247995.327848
 SAUDI ARABIA              |   1993 | 468771691.737166
 SAUDI ARABIA              |   1992 | 472982204.788197
 UNITED KINGDOM            |   1998 | 271233809.485784
 UNITED KINGDOM            |   1997 | 455989555.127161
 UNITED KINGDOM            |   1996 |  454362148.96075
 UNITED KINGDOM            |   1995 |  454466146.07826
 UNITED KINGDOM            |   1994 | 460369917.076793
 UNITED KINGDOM            |   1993 | 457980991.481376
 UNITED KINGDOM            |   1992 | 450805378.890864
 UNITED STATES             |   1998 | 274908908.816264
 UNITED STATES             |   1997 | 469194880.220027
 UNITED STATES             |   1996 | 462726143.927703
 UNITED STATES             |   1995 | 465064262.906597
 UNITED STATES             |   1994 | 472636685.516375
 UNITED STATES             |   1993 | 463273428.236677
 UNITED STATES             |   1992 |  467521213.23018
 VIETNAM                   |   1998 | 271081319.186892
 VIETNAM                   |   1997 | 458002940.594546
 VIETNAM                   |   1996 | 465702424.969498
 VIETNAM                   |   1995 | 462803656.972617
 VIETNAM                   |   1994 | 468532692.758822
 VIETNAM                   |   1993 | 466692710.039934
 VIETNAM                   |   1992 | 463260714.137437
(175 rows)

COMMIT;
COMMIT
